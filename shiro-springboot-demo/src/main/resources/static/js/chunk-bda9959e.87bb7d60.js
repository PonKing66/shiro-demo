(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-bda9959e"],{"0f69":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["user:add"],expression:"['user:add']"}],attrs:{type:"primary",icon:"el-icon-edit"},on:{click:e.handleCreate}},[e._v("新建用户")]),e._v(" "),r("el-table",{staticStyle:{width:"100%","margin-top":"30px"},attrs:{data:e.userList,border:""}},[r("el-table-column",{attrs:{prop:"id",label:"ID",width:"180",hidden:""}}),e._v(" "),r("el-table-column",{attrs:{prop:"username",label:"账号",width:"180"}}),e._v(" "),r("el-table-column",{attrs:{prop:"nickName",label:"名称",width:"180"}}),e._v(" "),r("el-table-column",{directives:[{name:"permission",rawName:"v-permission",value:["user:update"],expression:"['user:update']"}],attrs:{label:"操作",align:"center","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row,i=t.$index;return[r("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["user:update"],expression:"['user:update']"}],attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.handleUpdate(n)}}},[e._v("\n          编辑\n        ")]),e._v(" "),r("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["user:assign"],expression:"['user:assign']"}],attrs:{size:"mini",type:"info"},on:{click:function(t){return e.handleAssignRoles(n)}}},[e._v("\n          分配角色\n        ")]),e._v(" "),r("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["user:remove"],expression:"['user:remove']"}],attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleDelete(n,i)}}},[e._v("\n          删除\n        ")])]}}])})],1),e._v(" "),r("el-pagination",{staticStyle:{width:"80%","margin-top":"30px"},attrs:{total:e.total,"current-page":e.listQuery.page,"page-sizes":[3,5,10,20,30],"page-size":e.listQuery.limit,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),e._v(" "),r("el-dialog",{attrs:{title:1==e.isEdit?"更新用户":"新建用户",visible:e.userDialogFormVisible},on:{"update:visible":function(t){e.userDialogFormVisible=t}}},[r("el-form",{attrs:{model:e.userForm}},[r("el-form-item",{attrs:{label:"id","label-width":e.formLabelWidth,hidden:""}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.userForm.id,callback:function(t){e.$set(e.userForm,"id",t)},expression:"userForm.id"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"账号","label-width":e.formLabelWidth}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.userForm.username,callback:function(t){e.$set(e.userForm,"username",t)},expression:"userForm.username"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"称呼","label-width":e.formLabelWidth}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.userForm.nickName,callback:function(t){e.$set(e.userForm,"nickName",t)},expression:"userForm.nickName"}})],1),e._v(" "),e.isEdit?r("el-form-item",{attrs:{label:"原始密码","label-width":e.formLabelWidth}},[r("el-input",{attrs:{autocomplete:"off",type:"password"},model:{value:e.userForm.originPassword,callback:function(t){e.$set(e.userForm,"originPassword",t)},expression:"userForm.originPassword"}})],1):e._e(),e._v(" "),r("el-form-item",{attrs:{label:"密码","label-width":e.formLabelWidth}},[r("el-input",{attrs:{autocomplete:"off",type:"password"},model:{value:e.userForm.password,callback:function(t){e.$set(e.userForm,"password",t)},expression:"userForm.password"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"角色","label-width":e.formLabelWidth}},[r("el-checkbox",{attrs:{indeterminate:e.isIndeterminate},on:{change:e.handleCheckAllChange},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}},[e._v("全选")]),e._v(" "),r("div",{staticStyle:{margin:"15px 0"}}),e._v(" "),r("el-checkbox-group",{on:{change:e.handleCheckedRolesChange},model:{value:e.checkedRoles,callback:function(t){e.checkedRoles=t},expression:"checkedRoles"}},e._l(e.roles,(function(t){return r("el-checkbox",{key:t.id,attrs:{label:t.id}},[e._v(e._s(t.roleName))])})),1)],1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.userDialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.createOrUpdateUser}},[e._v("确 定")])],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"分配角色",visible:e.assignRolesDialogFormVisible},on:{"update:visible":function(t){e.assignRolesDialogFormVisible=t}}},[r("el-form",{attrs:{model:e.userForm}},[r("el-form-item",{attrs:{label:"角色","label-width":e.formLabelWidth}},[r("el-checkbox",{attrs:{indeterminate:e.isIndeterminate},on:{change:e.handleCheckAllChange},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}},[e._v("全选")]),e._v(" "),r("div",{staticStyle:{margin:"15px 0"}}),e._v(" "),r("el-checkbox-group",{on:{change:e.handleCheckedRolesChange},model:{value:e.checkedRoles,callback:function(t){e.checkedRoles=t},expression:"checkedRoles"}},e._l(e.roles,(function(t){return r("el-checkbox",{key:t.id,attrs:{label:t.id}},[e._v(e._s(t.roleName))])})),1)],1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.assignRolesDialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.assignRoles(e.userForm.id,e.checkedRoles)}}},[e._v("确 定")])],1)],1)],1)},i=[],s=r("b85c"),a=(r("96cf"),r("1da1")),o=r("4381"),l=r("e350"),c=r("c24f"),u=r("cc5e"),d={directives:{permission:o["a"]},data:function(){return{listQuery:{page:1,limit:3},total:0,userList:[],userForm:{},userDialogFormVisible:!1,assignRolesDialogFormVisible:!1,isEdit:!1,formLabelWidth:"120px",checkAll:!1,checkedRoles:[],roles:[],isIndeterminate:!0,allRoleChecked:[],key:1}},created:function(){this.getUserList(),this.createCheckedRole()},methods:{checkPermission:l["a"],handleRolesChange:function(){this.key++},getUserList:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(c["d"])(this.listQuery);case 2:t=e.sent,this.userList=t.data.users,this.total=t.data.total;case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),createOrUpdateUser:function(){!1===this.isEdit?this.createUser():this.updateUser()},updateUser:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.userForm.roles=this.checkedRoles,e.next=3,Object(c["i"])(this.userForm);case 3:this.userDialogFormVisible=!1,this.getUserList();case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),assignRoles:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(c["b"])(t,r);case 2:this.assignRolesDialogFormVisible=!1;case 3:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}(),handleAssignRoles:function(e){var t=this;this.userForm.roles=[],Object(c["f"])(e.id).then((function(e){t.userForm=e.data,t.checkedRoles=t.userForm.roles})),this.assignRolesDialogFormVisible=!0},createUser:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.userForm.roles=this.checkedRoles,e.next=3,Object(c["a"])(this.userForm);case 3:this.userDialogFormVisible=!1;case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),handleCreate:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.clearUserFrom(),this.isEdit=!1,this.userDialogFormVisible=!0;case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),handleUpdate:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.clearUserFrom(),this.isEdit=!0,Object(c["f"])(t.id).then((function(e){r.userForm=e.data,r.checkedRoles=r.userForm.roles})),this.userDialogFormVisible=!0;case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),handleDelete:function(e,t){var r=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(a["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(c["c"])(e.id);case 2:r.getUserList(),r.$message({type:"success",message:"删除成功!"});case 4:case"end":return t.stop()}}),t)})))).catch((function(){r.$message({type:"info",message:"已取消删除"})}))},clearUserFrom:function(){this.userForm={}},createCheckedRole:function(){var e=this;Object(u["c"])().then((function(t){e.roles=t.data;var r,n=Object(s["a"])(e.roles);try{for(n.s();!(r=n.n()).done;){var i=r.value;e.allRoleChecked.push(i.id)}}catch(a){n.e(a)}finally{n.f()}})),console.log(this.roles)},handleSizeChange:function(e){this.listQuery.limit=e,this.getUserList()},handleCurrentChange:function(e){this.listQuery.page=e,this.getUserList()},handleCheckAllChange:function(e){this.checkedRoles=e?this.allRoleChecked:[],this.isIndeterminate=!1},handleCheckedRolesChange:function(e){var t=e.length;this.checkAll=t===this.roles.length,this.isIndeterminate=t>0&&t<this.roles.length}}},h=d,m=r("2877"),p=Object(m["a"])(h,n,i,!1,null,null,null);t["default"]=p.exports},4381:function(e,t,r){"use strict";r("6762"),r("2fdb");var n=r("4360");function i(e,t){var r=t.value,i=n["a"].getters&&n["a"].getters.roles;if(!(r&&r instanceof Array))throw new Error("你没有权限访问");if(r.length>0){var s=r,a=i.some((function(e){return s.includes(e)}));a||e.parentNode&&e.parentNode.removeChild(e)}}var s={inserted:function(e,t){i(e,t)},update:function(e,t){i(e,t)}},a=function(e){e.directive("permission",s)};window.Vue&&(window["permission"]=s,Vue.use(a)),s.install=a;t["a"]=s},cc5e:function(e,t,r){"use strict";r.d(t,"d",(function(){return s})),r.d(t,"c",(function(){return a})),r.d(t,"a",(function(){return o})),r.d(t,"e",(function(){return l})),r.d(t,"b",(function(){return c}));var n=r("b775"),i="/api/admin/roles";function s(){return Object(n["a"])({url:"/api/admin/permissions",method:"get"})}function a(){return Object(n["a"])({url:"".concat(i),method:"get"})}function o(e){return Object(n["a"])({url:"".concat(i),method:"post",data:e})}function l(e,t){return Object(n["a"])({url:"".concat(i,"/").concat(e),method:"put",data:t})}function c(e){return Object(n["a"])({url:"".concat(i,"/").concat(e),method:"delete"})}},e350:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));r("6762"),r("2fdb");var n=r("4360");function i(e){if(e&&e instanceof Array&&e.length>0){var t=n["a"].getters&&n["a"].getters.roles,r=e,i=t.some((function(e){return r.includes(e)}));return!!i}return console.error("你没有权限访问"),!1}}}]);